FROM dimitri/pgloader:v3.6.7

# Install MySQL client and PostgreSQL client
RUN apt-get update && apt-get install -y default-mysql-client postgresql-client

# Set working directory
WORKDIR /app

# Copy migration script and SQL dump
COPY scripts/migrate.sh /app/scripts/migrate.sh
COPY packages/dataset/assets/1_bnwiki-latest-page.sql /app/dump.sql

# Make script executable
RUN mkdir -p /app/scripts && chmod +x /app/scripts/migrate.sh

ENTRYPOINT ["/app/scripts/migrate.sh"]
